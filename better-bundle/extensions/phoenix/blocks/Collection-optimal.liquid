{% comment %}
  Collection Page Recommendations - React Version
  Fetches and displays personalized collection-based recommendations
{% endcomment %}

<style>
  .phoenix-extension {
    --phoenix-card-bg: {{ block.settings.card_bg | default: '#ffffff' }};
    --phoenix-card-border-radius: {{ block.settings.card_border_radius | default: 8 }}px;
    --phoenix-title-color: {{ block.settings.title_color | default: '#1a202c' }};
    --phoenix-price-color: {{ block.settings.price_color | default: '#2d3748' }};
    --phoenix-button-bg: {{ block.settings.button_bg | default: '#000000' }};
    --phoenix-button-text: {{ block.settings.button_text | default: '#ffffff' }};
    --phoenix-button-border-radius: {{ block.settings.button_border_radius | default: 6 }}px;
    --phoenix-pagination-color: {{ block.settings.pagination_color | default: '#000000' }};
  }
</style>

<div
  class="phoenix-extension"
  data-phoenix-component="collection-recommendations"
  data-phoenix-props='
    {
      "limit": {{ block.settings.limit }},
      "enable_autoplay": {{ block.settings.enable_autoplay }},
      "autoplay_delay": {{ block.settings.autoplay_delay | times: 1000 }},
      "show_arrows": {{ block.settings.show_arrows }},
      "show_pagination": {{ block.settings.show_pagination }},
      "context": "collection_page",
      "product_ids": [],
      "currency": "{{ shop.currency }}",
      "title": "{{ block.settings.title }}"
    }
  '
  {% if collection %}
    data-collection-id="{{ collection.id }}"
  {% endif %}
>
  <div class="phoenix-loading">
    <p>Loading recommendationsâ€¦</p>
  </div>
</div>

<link rel="stylesheet" href="{{ 'phoenix.css' | asset_url }}">
<script src="{{ 'phoenix.js' | asset_url }}" defer></script>

{% schema %}
{
  "name": "Collection",
  "target": "section",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Carousel Title",
      "default": "Recommended Products",
      "info": "Display title above the product carousel"
    },
    {
      "type": "range",
      "id": "limit",
      "label": "Number of Products",
      "min": 4,
      "max": 8,
      "step": 1,
      "default": 6
    },

    { "type": "header", "content": "Card Styles" },
    {
      "type": "range",
      "id": "card_border_radius",
      "label": "Card Border Radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 8
    },
    { "type": "color", "id": "card_bg", "label": "Card Background", "default": "#ffffff" },
    { "type": "color", "id": "title_color", "label": "Title Color", "default": "#1a202c" },
    { "type": "color", "id": "price_color", "label": "Price Color", "default": "#2d3748" },
    { "type": "color", "id": "button_bg", "label": "Button Background", "default": "#000000" },
    { "type": "color", "id": "button_text", "label": "Button Text Color", "default": "#ffffff" },
    {
      "type": "range",
      "id": "button_border_radius",
      "label": "Button Border Radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 6
    },

    { "type": "header", "content": "Controls" },
    { "type": "checkbox", "id": "show_arrows", "label": "Show Arrows", "default": true },
    { "type": "checkbox", "id": "show_pagination", "label": "Show Pagination", "default": true },
    { "type": "color", "id": "pagination_color", "label": "Pagination Color", "default": "#000000" },
    { "type": "checkbox", "id": "enable_autoplay", "label": "Enable Autoplay", "default": true },
    {
      "type": "range",
      "id": "autoplay_delay",
      "label": "Autoplay Delay (seconds)",
      "min": 1,
      "max": 10,
      "step": 0.5,
      "default": 2.5,
      "unit": "s"
    }
  ]
}
{% endschema %}
