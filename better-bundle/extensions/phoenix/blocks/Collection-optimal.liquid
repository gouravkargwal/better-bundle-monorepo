{% comment %}
  Optimal Collection Page Recommendations - Smart Category Filtering
  Backend intelligently chooses the best recommendation type based on visitor type and category:
  - New visitors: Most Popular in Category (social proof)
  - Returning visitors: Personalized within Category (personalized)
  - Fallback: General popular items
{% endcomment %}

{% assign dummy_data = 'Category Item 1,Category Item 2,Category Item 3,Category Item 4,Category Item 5,Category Item 6|39.99,54.99,69.99,84.99,99.99,114.99|9b59b6,3498db,e74c3c,f39c12,2ecc71,1abc9c|Size: S|Size: M|Size: L|Size: XL,Color: Navy|Color: Black|Color: White,Size: 28|Size: 30|Size: 32|Size: 34,Color: Indigo|Color: Black|Color: Light Blue,Size: Small|Size: Medium|Size: Large,Color: Purple|Color: Pink|Color: Lavender,Size: 6|Size: 7|Size: 8|Size: 9,Color: Green|Color: Blue|Color: Teal|1,1,1,1,1,1'
  | split: '|'
%}

{% comment %}
  Smart Collection Block - Auto-detects context based on page type
  Can be used on any page and will automatically use the correct context
{% endcomment %}

{% assign block_context = 'collection_page' %}
{% if template.name == 'index' or template.name == 'page' %}
  {% assign block_context = 'homepage' %}
{% elsif template.name == 'cart' %}
  {% assign block_context = 'cart' %}
{% elsif template.name == 'product' %}
  {% assign block_context = 'product_page' %}
{% endif %}

{% render 'recommendation-base', context: block_context, collection_id: collection.id, dummy_data: dummy_data %}

{% schema %}
{
  "name": "Collection",
  "target": "section",
  "tag": "section",
  "settings": [
    { "type": "header", "content": "Section Heading" },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "You might also like"
    },
    {
      "type": "select",
      "id": "heading_size",
      "label": "Heading Size",
      "options": [
        { "value": "h1", "label": "H1" },
        { "value": "h2", "label": "H2" },
        { "value": "h3", "label": "H3" },
        { "value": "h4", "label": "H4" }
      ],
      "default": "h3"
    },
    {
      "type": "select",
      "id": "heading_alignment",
      "label": "Heading Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    { "type": "color", "id": "heading_color", "label": "Heading Color", "default": "#1e293b" },
    { "type": "checkbox", "id": "show_heading", "label": "Show Heading", "default": true },

    { "type": "header", "content": "Card Styles" },
    {
      "type": "range",
      "id": "card_border_radius",
      "label": "Card Border Radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 8
    },
    { "type": "color", "id": "card_bg", "label": "Card Background", "default": "#ffffff" },
    { "type": "color", "id": "title_color", "label": "Title Color", "default": "#1a202c" },
    { "type": "color", "id": "price_color", "label": "Price Color", "default": "#2d3748" },
    { "type": "color", "id": "button_bg", "label": "Button Background", "default": "#000000" },
    { "type": "color", "id": "button_text", "label": "Button Text Color", "default": "#ffffff" },
    {
      "type": "range",
      "id": "button_border_radius",
      "label": "Button Border Radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "default": 6
    },

    { "type": "header", "content": "Controls" },
    { "type": "checkbox", "id": "show_arrows", "label": "Show Arrows", "default": true },
    { "type": "checkbox", "id": "show_pagination", "label": "Show Pagination", "default": true },
    { "type": "color", "id": "pagination_color", "label": "Pagination Color", "default": "#000000" },
    { "type": "checkbox", "id": "enable_autoplay", "label": "Enable Autoplay", "default": true },
    {
      "type": "range",
      "id": "autoplay_delay",
      "label": "Autoplay Delay (seconds)",
      "min": 1,
      "max": 10,
      "step": 0.5,
      "default": 2.5,
      "unit": "s"
    }
  ]
}
{% endschema %}
